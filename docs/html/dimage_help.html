<!-- This file was generated by make_html_help.pro -->
<html>
 
<head>
<TITLE>IDL Help for DIMAGE</TITLE>
</head>
 
<body>
<H1>IDL Help for DIMAGE</H1>
<P>
This page was created by the IDL library routine 
<CODE>make_html_help</CODE>.  For more information on 
this routine, refer to the IDL Online Help Navigator 
or type: <P>
<PRE>     ? make_html_help</PRE><P>
at the IDL command line prompt.<P>
<STRONG>Last modified: </STRONG>Thu Dec  6 14:18:12 2007.<P>
 
<HR>
 
<A NAME="ROUTINELIST">
<H1>List of Routines</H1></A>
<UL>
<LI><A HREF="#ATV2">ATV2</A>-- Interactive display of 2-D images.
<LI><A HREF="#ATV3">ATV3</A>-- Interactive display of 2-D images.
<LI><A HREF="#DCEN3X3">DCEN3X3</A>-- 
fit center to a 3x3 image with a peak in the center
<LI><A HREF="#DCHILDREN">DCHILDREN</A>-- 
deblend children of a parent, in multi-band, multi-res images
<LI><A HREF="#DETECT">DETECT</A>-- 
detect objects in multi-band, multi-res images
<LI><A HREF="#DEXPLORE">DEXPLORE</A>-- interactive explorer of dimage results
<LI><A HREF="#DEXTRACT">DEXTRACT</A>-- 
extract objects in an image based on object image
<LI><A HREF="#DFAKEGAL">DFAKEGAL</A>-- 
get parameters associated with sersic settings
<LI><A HREF="#DFIND">DFIND</A>-- identify objects in a boolean image
<LI><A HREF="#DFITPSF">DFITPSF</A>-- fit a PSF model to an image
<LI><A HREF="#DFLUXES">DFLUXES</A>-- 
get pixel fluxes of children, given weights and templates
<LI><A HREF="#DGALS">DGALS</A>-- 
find galaxies in multi-band, multi-res images (called by dchildren)
<LI><A HREF="#DIMAGE_FLAGNAME">DIMAGE_FLAGNAME</A>-- 
Return bitmask labels corresponding to bit numbers.
<LI><A HREF="#DIMAGE_FLAGVAL">DIMAGE_FLAGVAL</A>-- 
Return bitmask values corresponding to labels.
<LI><A HREF="#DMEDSMOOTH">DMEDSMOOTH</A>-- median smooth
<LI><A HREF="#DOBJECTS">DOBJECTS</A>-- 
detect objects in multi-band, multi-res images
<LI><A HREF="#DPARENTS">DPARENTS</A>-- 
find parent objects in multi-band, multi-res images
<LI><A HREF="#DPEAKS">DPEAKS</A>-- find peaks in an image
<LI><A HREF="#DPREFINE">DPREFINE</A>-- refine a psf center
<LI><A HREF="#DPSFCHECK">DPSFCHECK</A>-- check how well a PSF fits some data
<LI><A HREF="#DPSFREAD">DPSFREAD</A>-- read a PSF structure from a file
<LI><A HREF="#DPSFSUB">DPSFSUB</A>-- 
return an attempt at subtracting the fit PSF from some image
<LI><A HREF="#DREFINE">DREFINE</A>-- refine some approximate centers
<LI><A HREF="#DSERSIC">DSERSIC</A>-- run 2d sersic fitting on an image
<LI><A HREF="#DSERSIC2">DSERSIC2</A>-- 
run 2d, two-component sersic fitting on an image
<LI><A HREF="#DSERSIC_PARAMS">DSERSIC_PARAMS</A>-- given flux, r50, n
<LI><A HREF="#DSIGMA">DSIGMA</A>-- find approximate sigma from image
<LI><A HREF="#DSMOOTH">DSMOOTH</A>-- smooth with a simple gaussian
<LI><A HREF="#DSTARS">DSTARS</A>-- 
find stars in multi-band, multi-res images (called by dchildren)
<LI><A HREF="#DTEMPLATES">DTEMPLATES</A>-- build templates around centers
<LI><A HREF="#DUMMY_PSF">DUMMY_PSF</A>-- 
return a dummy psf for cases where it is unknown
<LI><A HREF="#DVPSF">DVPSF</A>-- 
given a PSF structure, return the PSF at a particular point
<LI><A HREF="#DWEIGHTS">DWEIGHTS</A>-- fit templates to image
<LI><A HREF="#FIT_MULT_GAUSS">FIT_MULT_GAUSS</A>-- 
fit multiple gaussians centered at center to an image
<LI><A HREF="#SIMPLEXY">SIMPLEXY</A>-- 
get basic X and Y for brightish sources away from edge of an image
<LI><A HREF="#TWOMASS_CONVERT">TWOMASS_CONVERT</A>-- 
convert twomass images to sky-subtracted versions with nice names
</UL><P>
 
<HR>
 
<H1>Routine Descriptions</H1>
<A NAME="ATV2">
<H2>ATV2</H2></A>
<A HREF="#ATV3">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       ATV2
 
 PURPOSE: 
       Interactive display of 2-D images.

 CATEGORY: 
       Image display.

 CALLING SEQUENCE:
       atv2 [,array_name OR fits_file] [,min = min_value] [,max=max_value] 
           [,/linear] [,/log] [,/histeq] [,/block]
           [,/align] [,/stretch] [,header = header]

 REQUIRED INPUTS:
       None.  If atv2 is run with no inputs, the window widgets
       are realized and images can subsequently be passed to atv2
       from the command line or from the pull-down file menu.

 OPTIONAL INPUTS:
       array_name: a 2-D data array to display
          OR
       fits_file:  a fits file name, enclosed in single quotes

 KEYWORDS:
       min:        minimum data value to be mapped to the color table
       max:        maximum data value to be mapped to the color table
       linear:     use linear stretch
       log:        use log stretch 
       histeq:     use histogram equalization
       block:      block IDL command line until ATV2 terminates
       align:      align image with previously displayed image
       stretch:    keep same min and max as previous image
       header:     FITS image header (string array) for use with data array
       
 OUTPUTS:
       None.  
 
 COMMON BLOCKS:
       atv2_state:  contains variables describing the display state
       atv2_images: contains the internal copies of the display image
       atv2_color:  contains colormap vectors
       atv2_pdata:  contains plot and text annotation information

 RESTRICTIONS:
       Requires IDL version 5.1 or greater.
       Requires Craig Markwardt's cmps_form.pro routine.
       Requires the GSFC IDL astronomy user's library routines.
       Some features may not work under all operating systems.

 SIDE EFFECTS:
       Modifies the color table.

 EXAMPLE:
       To start atv2 running, just enter the command 'atv2' at the idl
       prompt, either with or without an array name or fits file name 
       as an input.  Only one atv2 window will be created at a time,
       so if one already exists and another image is passed to atv2
       from the idl command line, the new image will be displayed in 
       the pre-existing atv2 window.

 MODIFICATION HISTORY:
       Written by Aaron J. Barth, with contributions by 
       Douglas Finkbeiner, Michael Liu, David Schlegel, and
       Wesley Colley.  First released 17 December 1998.

       This version is 1.4, last modified 23 June 2003.

       For the most current version, revision history, instructions,
       list of known bugs, and further information, go to:
              http://www.astro.caltech.edu/~barth/atv2

       Hacked up by Finkbeiner 5 December 2003 to support healpix.
;-
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/utils/atv2.pro)</STRONG><P>
<HR>
 
<A NAME="ATV3">
<H2>ATV3</H2></A>
<A HREF="#ATV2">[Previous Routine]</A>
<A HREF="#DCEN3X3">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       ATV3
 
 PURPOSE: 
       Interactive display of 2-D images.

 CATEGORY: 
       Image display.

 CALLING SEQUENCE:
       atv3 [,array_name OR fits_file] [,min = min_value] [,max=max_value] 
           [,/linear] [,/log] [,/histeq] [,/block]
           [,/align] [,/stretch] [,header = header]

 REQUIRED INPUTS:
       None.  If atv3 is run with no inputs, the window widgets
       are realized and images can subsequently be passed to atv3
       from the command line or from the pull-down file menu.

 OPTIONAL INPUTS:
       array_name: a 2-D data array to display
          OR
       fits_file:  a fits file name, enclosed in single quotes

 KEYWORDS:
       min:        minimum data value to be mapped to the color table
       max:        maximum data value to be mapped to the color table
       linear:     use linear stretch
       log:        use log stretch 
       histeq:     use histogram equalization
       block:      block IDL command line until ATV3 terminates
       align:      align image with previously displayed image
       stretch:    keep same min and max as previous image
       header:     FITS image header (string array) for use with data array
       
 OUTPUTS:
       None.  
 
 COMMON BLOCKS:
       atv3_state:  contains variables describing the display state
       atv3_images: contains the internal copies of the display image
       atv3_color:  contains colormap vectors
       atv3_pdata:  contains plot and text annotation information

 RESTRICTIONS:
       Requires IDL version 5.1 or greater.
       Requires Craig Markwardt's cmps_form.pro routine.
       Requires the GSFC IDL astronomy user's library routines.
       Some features may not work under all operating systems.

 SIDE EFFECTS:
       Modifies the color table.

 EXAMPLE:
       To start atv3 running, just enter the command 'atv3' at the idl
       prompt, either with or without an array name or fits file name 
       as an input.  Only one atv3 window will be created at a time,
       so if one already exists and another image is passed to atv3
       from the idl command line, the new image will be displayed in 
       the pre-existing atv3 window.

 MODIFICATION HISTORY:
       Written by Aaron J. Barth, with contributions by 
       Douglas Finkbeiner, Michael Liu, David Schlegel, and
       Wesley Colley.  First released 17 December 1998.

       This version is 1.4, last modified 23 June 2003.

       For the most current version, revision history, instructions,
       list of known bugs, and further information, go to:
              http://www.astro.caltech.edu/~barth/atv3

       Hacked up by Finkbeiner 5 December 2003 to support healpix.
;-
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/utils/atv3.pro)</STRONG><P>
<HR>
 
<A NAME="DCEN3X3">
<H2>DCEN3X3</H2></A>
<A HREF="#ATV3">[Previous Routine]</A>
<A HREF="#DCHILDREN">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dcen3x3
 PURPOSE:
   fit center to a 3x3 image with a peak in the center
 CALLING SEQUENCE:
   dcen3x3, image, xcen, ycen
 INPUTS:
   image - [3, 3] input image
 OUTPUTS:
   xcen, ycen - fit peak (pixels run from 0-2)
 REVISION HISTORY:
   1-Mar-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dcen3x3.pro)</STRONG><P>
<HR>
 
<A NAME="DCHILDREN">
<H2>DCHILDREN</H2></A>
<A HREF="#DCEN3X3">[Previous Routine]</A>
<A HREF="#DETECT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dchildren
 PURPOSE:
   deblend children of a parent, in multi-band, multi-res images
 CALLING SEQUENCE:
   dchildren, base, iparent [, psfs=, plim=, gsmooth=, glim=, $
      saddle=, xstars=, ystars=, xgals=, ygals=, /hand, ref=, $
      nstars=, /sersic ]
 INPUTS:
   base - FITS image base name
   iparent - parent to process 
 OPTIONAL KEYWORDS:
   /hand - brings up ATV so user can pick galaxy and star centers
   /sersic - fit template with Sersic profile to constrain better
   /aset - use [base]-aset.fits file for parameter setting
   /sgset - use [base]-aset.fits file for star and galaxy locations
 OPTIONAL INPUTS:
   psf - [npx, npy] PSF to assume (if none, doesn't search for stars)
   plim - nsigma limit for point source detection (default 5.)
   glim - nsigma limit for galaxy detection (default 5.)
   gsmooth - smoothing for galaxy detection (default 2.)
   saddle - saddle point for galaxy peak checking (default 100.)
   xstars, ystars - [N] input where you want stars assumed
   xgals, ygals - [N] input where you want galaxies assumed
   ref - reference band (default 0)
   sdss - pass this to dvpsf() to use SDSS PSF estimate
   puse - [Nband] 0 or 1 whether to detect stars and galaxies in each
          band
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dchildren.pro)</STRONG><P>
<HR>
 
<A NAME="DETECT">
<H2>DETECT</H2></A>
<A HREF="#DCHILDREN">[Previous Routine]</A>
<A HREF="#DEXPLORE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   detect
 PURPOSE:
   detect objects in multi-band, multi-res images 
 CALLING SEQUENCE:
   detect, base, imfile [, /pset, /aset
 INPUTS:
   base - base name for output
   imfiles - [Nband] array of FITS files with images in HDU 0
 OPTIONAL INPUTS:
   ref - integer indicating which imfile is the &quot;reference&quot;
   sky - if set, subtracts a median smoothed sky with this box size
         (in arcsec)
   glim - number of sigma for a galaxy detection (default 20)
   gsmooth - smoothing scale for galaxies (default 5)
   single - if set, only process this parent number
   puse - [Nband] 0 or 1, whether to use band to find parents
 OPTIONAL KEYWORDS:
   /all - process all parents
   /pset - use &quot;parent&quot; settings from base-pset.fits file
   /aset - use &quot;child&quot; settings from base-aset.fits file
   /sgset - get locations of stars and galaxies from base-sgset.fits file
   /hand - for children, put results in &quot;hand&quot; subdir (used by dexplore)
   /noclobber - do not overwrite previously created files
 COMMENTS:
   When calling automatically, it is best not to use the /hand
     option; reserve that for when dexplore calls this function and you
     have set the parameters by hand.
   Assumes that multi-res images are APPROXIMATELY overlapping
     (within a pixel or two)
   Assumes a sky-subtracted image in HDU 0
   Works better if ivars supplied in HDU 1
   Finds objects, selects largest one to deblend 
   Outputs (assuming imfile is 'base.fits' or 'base.fits.gz'):
     base-dbset.fits - settings, locations of stars and gals, etc
     base-bpsf.fits - &quot;basic&quot; PSF estimate
     base-pcat.fits - locations of parents in full image
     base-parents.fits - in HDUs 2N+1 and 2N+2, imagse and ivars of parents
     base-[parent]-atlas.fits - images of children of biggest parent
     base-[parent].tar.gz - tar file with JPGs, etc
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/detect.pro)</STRONG><P>
<HR>
 
<A NAME="DEXPLORE">
<H2>DEXPLORE</H2></A>
<A HREF="#DETECT">[Previous Routine]</A>
<A HREF="#DEXTRACT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dexplore
 PURPOSE:
   interactive explorer of dimage results
 CALLING SEQUENCE:
   dexplore [, base ]
 OPTIONAL INPUTS:
   base - base name for output (otherwise uses current dir name)
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dexplore.pro)</STRONG><P>
<HR>
 
<A NAME="DEXTRACT">
<H2>DEXTRACT</H2></A>
<A HREF="#DEXPLORE">[Previous Routine]</A>
<A HREF="#DFAKEGAL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dextract
 PURPOSE:
   extract objects in an image based on object image
 CALLING SEQUENCE:
   dextract, image, invvar, object=object, extract=extract [, small=]
 INPUTS:
   image - [nx, ny] input image
   invvar - [nx, ny] input image inverse variance
   object - [nx, ny] which object each pixel corresponds to
 OPTIONAL INPUTS:
   small - if set, only process objects with size of detected area
           smaller than this value
 OUTPUTS:
   extract - [N] arrays of structures with objects and properties
                 .XST - X start of atlas
                 .YST - Y start of atlas
                 .XND - X end of atlas
                 .YND - Y end of atlas
                 .XCEN
                 .YCEN
                 .ATLAS - atlas structure
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dextract.pro)</STRONG><P>
<HR>
 
<A NAME="DFAKEGAL">
<H2>DFAKEGAL</H2></A>
<A HREF="#DEXTRACT">[Previous Routine]</A>
<A HREF="#DFIND">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dfakegal
 PURPOSE:
   get parameters associated with sersic settings
 CALLING SEQUENCE:
   im= dfakegal([ sersicn=, r50=, flux=, phi0=, ba=, /simple, $
                  nx=, ny=, xcen=, ycen=, sersic= ])
 INPUTS:
   flux - flux (default 1.)
   sersicn - Sersic index (default 1.)
   r50 - half-light radius (default 1.)
   phi0 - position angle (deg counterclockwise from up, default 0.)
   ba - axis ratio (b/a, default 1.)
   nx, ny - size of output image (defuat 
 OUTPUTS:
   amp - amplitude 
   r0 - radius
 OPTIONAL OUTPUTS:
 OPTIONAL INPUTS/OUTPUTS:
 COMMENTS:
   I(r)= amp*exp(-(r/r0)^(1/n))
 DEPENDENCIES:
 BUGS:
 REVISION HISTORY:
   2003-09-21  Written MRB (NYU)
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/sersic/dfakegal.pro)</STRONG><P>
<HR>
 
<A NAME="DFIND">
<H2>DFIND</H2></A>
<A HREF="#DFAKEGAL">[Previous Routine]</A>
<A HREF="#DFITPSF">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dfind
 PURPOSE:
   identify objects in a boolean image
 CALLING SEQUENCE:
   dfind, image [, object= ]
 INPUTS:
   image - [nx, ny] input image
 OUTPUTS:
   object - [nx, ny] -1 where no object, object # otherwise
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dfind.pro)</STRONG><P>
<HR>
 
<A NAME="DFITPSF">
<H2>DFITPSF</H2></A>
<A HREF="#DFIND">[Previous Routine]</A>
<A HREF="#DFLUXES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dfitpsf
 PURPOSE:
   fit a PSF model to an image
 CALLING SEQUENCE:
   dfitpsf, imfile
 INPUTS:
   imfile - input FITS file
 OPTIONAL INPUTS:
   natlas   - size of the PSF postage stamp (default 41)
   maxnstar - maximum number of stars to use when constructing the
              PSF (default 200)
   
 KEYWORD PARAMETERS:
   noclobber - if the PSF files already exist, do nothing and return 
 COMMENTS:
   Currently always uses Nc=1 (no varying PSFs allowed)
   Seems to work OK but many arbitrary parameters.
   Ouputs (imfile is base.fits or base.fits.gz):
     base-bpsf.fits - basic (single-fit) PSF
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/psf/dfitpsf.pro)</STRONG><P>
<HR>
 
<A NAME="DFLUXES">
<H2>DFLUXES</H2></A>
<A HREF="#DFITPSF">[Previous Routine]</A>
<A HREF="#DGALS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dfluxes
 PURPOSE:
   get pixel fluxes of children, given weights and templates
 CALLING SEQUENCE:
   dfluxes, image, templates, weights, xcen, ycen, children= [, sigma= ]
 INPUTS:
   image - [nx, ny] input image
   templates - [nx, ny, N] templates 
   weights - [N] weights of templates 
   xcen, ycen - [N] centers of templates 
 OPTIONAL INPUTS;
   sigma - error level of image
 OUTPUTS:
   children - [nx, ny, N] resulting children
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU, based on RHL deblend
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dfluxes.pro)</STRONG><P>
<HR>
 
<A NAME="DGALS">
<H2>DGALS</H2></A>
<A HREF="#DFLUXES">[Previous Routine]</A>
<A HREF="#DIMAGE_FLAGNAME">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dgals
 PURPOSE:
   find galaxies in multi-band, multi-res images (called by dchildren)
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dgals.pro)</STRONG><P>
<HR>
 
<A NAME="DIMAGE_FLAGNAME">
<H2>DIMAGE_FLAGNAME</H2></A>
<A HREF="#DGALS">[Previous Routine]</A>
<A HREF="#DIMAGE_FLAGVAL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dimage_flagname

 PURPOSE:
   Return bitmask labels corresponding to bit numbers.

 CALLING SEQUENCE:
   label = dimage_flagname(flagprefix, flagvalue, [ /concat, /silent ] )

 INPUTS:
   flagprefix - Flag name (scalar string).  The following are supported:
                SPPIXMASK, TARGET, TTARGET.
   flagvalue  - Signed long with any number of its bits set.

 OPTIONAL KEYWORDS:
   concat     - If set, then concatenate all of the output labels in
                LABEL into a single whitespace-separated string.
   silent     - If set, then don't print a warning when there is no bit label
                corresponding to one of the bit values.

 OUTPUTS:
   label      - String name(s) corresponding to each non-zero bit in FLAGVALUE.

 OPTIONAL OUTPUTS:

 COMMENTS:
   This function is the inverse of DIMAGE_FLAGVAL().

 EXAMPLES:

 BUGS:

 PROCEDURES CALLED:
   splog
   yanny_free
   yanny_read

 DATA FILES:
   $DIMAGE_DIR/data/dimage/dimage_maskbits.par

 REVISION HISTORY:
   01-Apr-2002 Written by D. Schlegel, Princeton.
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/utils/dimage_flagname.pro)</STRONG><P>
<HR>
 
<A NAME="DIMAGE_FLAGVAL">
<H2>DIMAGE_FLAGVAL</H2></A>
<A HREF="#DIMAGE_FLAGNAME">[Previous Routine]</A>
<A HREF="#DMEDSMOOTH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dimage_flagval

 PURPOSE:
   Return bitmask values corresponding to labels.

 CALLING SEQUENCE:
   value = dimage_flagval(flagprefix, label)

 INPUTS:
   flagprefix - Flag name (scalar string).  The following are supported:
                SPPIXMASK, TARGET, TTARGET.
   label      - String name(s) corresponding to each non-zero bit in FLAGVALUE.

 OPTIONAL KEYWORDS:

 OUTPUTS:
   value      - Signed long with any number of its bits set.

 OPTIONAL OUTPUTS:

 COMMENTS:
   This function is the inverse of DIMAGE_FLAGNAME().

 DATA FILES:
   $DIMAGE_DIR/data/dimage/dimage_maskbits.par

 REVISION HISTORY:
   02-Apr-2002 Written by D. Schlegel, Princeton.
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/utils/dimage_flagval.pro)</STRONG><P>
<HR>
 
<A NAME="DMEDSMOOTH">
<H2>DMEDSMOOTH</H2></A>
<A HREF="#DIMAGE_FLAGVAL">[Previous Routine]</A>
<A HREF="#DOBJECTS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dmedsmooth
 PURPOSE:
   median smooth 
 CALLING SEQUENCE:
   smooth= dmedsmooth(image, invvar, box=)
 INPUTS:
   image - [nx, ny] input image
   invvar - [nx, ny] invverse variance
   box - box size for smooth
 OUTPUTS:
   smooth - [nx, ny] smooth image
 COMMENTS:
   Doesn't weight by inverse variance: just ignores invvar=0 data
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dmedsmooth.pro)</STRONG><P>
<HR>
 
<A NAME="DOBJECTS">
<H2>DOBJECTS</H2></A>
<A HREF="#DMEDSMOOTH">[Previous Routine]</A>
<A HREF="#DPARENTS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dobjects
 PURPOSE:
   detect objects in multi-band, multi-res images
 CALLING SEQUENCE:
   dobjects, images, objects= [, dpsf=, plim=]
 INPUTS:
   images - [nim] pointer to images, OR 
            [nx,ny,nim] array of images
 OPTIONAL INPUTS:
   dpsf - smoothing of PSF for detection (defaults to sigma=1 pixel)
   plim - limiting significance in sky sigma (defaults to 10 sig )
   puse - [nim] 0 or 1 whether to use image to detect
 OUTPUTS:
   objects - [nim] pointer to object images OR 
             [nx, ny] object image; object image has which object
             each pixel belongs to (-1 if none)
   fobject - [max(nx), max(ny)] full object image at highest res
 COMMENTS:
   Any detected pixel in any band counts as a detection.
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dobjects.pro)</STRONG><P>
<HR>
 
<A NAME="DPARENTS">
<H2>DPARENTS</H2></A>
<A HREF="#DOBJECTS">[Previous Routine]</A>
<A HREF="#DPEAKS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dparents
 PURPOSE:
   find parent objects in multi-band, multi-res images
 CALLING SEQUENCE:
   dparents, base, imfiles, [plim=, ref=, sky=, /noclobber ]
 INPUTS:
   base - base name for output
   imfiles - [Nband] array of FITS files with images in HDU 0
 OPTIONAL INPUTS:
   plim - significance to detect (default 5.)
   ref - integer indicating which imfile is the &quot;reference&quot;
   sky - if set, subtracts a median smoothed sky with this box size
         (in arcsec)
 OPTIONAL KEYWORDS:
   /noclobber - do not overwrite previously created files
 COMMENTS:
   Creates files:
      base-#-pimage.fits - image with parent number in each pixel
      base-#-pcat.fits - image with parent number in each pixel
      parents/base-parent-[parent].fits - multi-HDU file with
                                          individual parents
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dparents.pro)</STRONG><P>
<HR>
 
<A NAME="DPEAKS">
<H2>DPEAKS</H2></A>
<A HREF="#DPARENTS">[Previous Routine]</A>
<A HREF="#DPREFINE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dpeaks
 PURPOSE:
   find peaks in an image
 CALLING SEQUENCE:
   dpeaks, image [, xcen=, ycen=, sigma=, dlim=, maxnpeaks=, $
      saddle=, minpeak=, npeaks=, /smooth, /checkpeaks, /refine ]
 INPUTS:
   image - [nx, ny] input image
 OPTIONAL INPUTS:
   sigma - sky sigma (defaults to estimate from dsigma.pro)
   dlim - limiting separation for identical peaks (default 1)
   maxnpeaks - maximum number of peaks to return (default 1000)
   minpeak - minimum peak value (defaults to 1 sigma)
   saddle - saddle point limit when checking peak separation 
            (default 3.)
 OPTIONAL KEYWORDS:
   /smooth - smooth a bit before finding
   /checkpeaks - check for peaks which are too connected to each other
   /refine - refines peak estimates
 OUTPUTS:
   xcen, ycen - [npeaks] positions of peaks
   npeaks - number of peaks
 COMMENTS:
   When /checkpeaks is set, checks whether saddle points between peak
     pairs are &gt; peak-saddle*sigma; if so, those peaks are joined.
   When /refine is not set, just finds to nearest pixel; when /refine
     is set, uses gaussian approximation to guess peak center.
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dpeaks.pro)</STRONG><P>
<HR>
 
<A NAME="DPREFINE">
<H2>DPREFINE</H2></A>
<A HREF="#DPEAKS">[Previous Routine]</A>
<A HREF="#DPSFCHECK">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dprefine
 PURPOSE:
   refine a psf center
 CALLING SEQUENCE:
   dprefine, image, psf, xc, yc, [, xr=, yr= ]
 INPUTS:
   image - [nx, ny] image
   psf - [npx, npy] estimated psf
   xc, yc - [N] centers to refine around
 OUTPUTS:
   xr, yr - [N] output centers
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dprefine.pro)</STRONG><P>
<HR>
 
<A NAME="DPSFCHECK">
<H2>DPSFCHECK</H2></A>
<A HREF="#DPREFINE">[Previous Routine]</A>
<A HREF="#DPSFREAD">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dpsfcheck
 PURPOSE:
   check how well a PSF fits some data
 CALLING SEQUENCE:
   ispsf= dpsfcheck(image, ivar, x, y [, psf=, amp= ])
 INPUTS:
   image - [nx, ny] input image
   ivar - [nx, ny] input invverse variance
   x, y - [N] positions to check
   psf - [npx, npy] PSF image
 OUTPUTS:
   ispsf - [N] 1 for PSF, 0 otherwise
   amp - amplitude of fit (after peak-normalizing PSF)
 COMMENTS:
   Fits a simple linear background plus the PSF.  Subtracts off the
   model, median smoothes the image in FWHM boxes, and calls it a PSF
   if the median smoothed image is &lt; 0.1 times the original image at
   the PSF peak. 
 REVISION HISTORY:
   1-Mar-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/psf/dpsfcheck.pro)</STRONG><P>
<HR>
 
<A NAME="DPSFREAD">
<H2>DPSFREAD</H2></A>
<A HREF="#DPSFCHECK">[Previous Routine]</A>
<A HREF="#DPSFSUB">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dpsfread
 PURPOSE:
   read a PSF structure from a file
 CALLING SEQUENCE:
   psfstr= dpsfread(psffile)
 INPUTS:
   psffile - input FITS file output by dpsffit
 OUTPUTS:
   psfstr - structure with:
             NX
             NY
             COEFFS[NP, NC]
             PSFT[NATLAS, NATLAS, NC]
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/psf/dpsfread.pro)</STRONG><P>
<HR>
 
<A NAME="DPSFSUB">
<H2>DPSFSUB</H2></A>
<A HREF="#DPSFREAD">[Previous Routine]</A>
<A HREF="#DREFINE">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dpsfsub
 PURPOSE:
   return an attempt at subtracting the fit PSF from some image
 CALLING SEQUENCE:
   subim= dpsfsub(imbas)
 INPUTS:
   imbase - file base name (full name should be imbase+'.fits.gz')
 OUTPUTS:
   subim - attempt at fitting and subtracting PSFs
 REVISION HISTORY:
   1-Mar-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/psf/dpsfsub.pro)</STRONG><P>
<HR>
 
<A NAME="DREFINE">
<H2>DREFINE</H2></A>
<A HREF="#DPSFSUB">[Previous Routine]</A>
<A HREF="#DSERSIC">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   drefine
 PURPOSE:
   refine some approximate centers
 CALLING SEQUENCE:
   drefine, image, xc, yc, [, box=, smooth=, xr=, yr= ]
 INPUTS:
   image - [nx, ny] image
   xc, yc - [N] centers to refine around
 OUTPUTS:
   xr, yr - [N] output centers
 OPTIONAL INPUTS:
   box - size of box to refine within (default 3)
   smooth - sigma for gaussian smoothing (default 0, no smoothing)
 COMMENTS:
   box sizes will be change to be odd, and &gt;=3.
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/drefine.pro)</STRONG><P>
<HR>
 
<A NAME="DSERSIC">
<H2>DSERSIC</H2></A>
<A HREF="#DREFINE">[Previous Routine]</A>
<A HREF="#DSERSIC2">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dsersic
 PURPOSE:
   run 2d sersic fitting on an image
 CALLING SEQUENCE:
   dsersic,image [,invvar,xcen=,ycen=,psf=,sersicfit=, $
      model=, /reinit, fixsky, /fixcen]
 INPUTS:
   image - [nx,ny] input image
 OPTIONAL INPUTS:
   invvar - [nx,ny] input inverse variance [default to unity everywhere]
   xcen - center of image [default to nx/2L]
   ycen - center of image [default to ny/2L]
   psf - [nxpsf,nypsf] estimated psf [default to just pixel convolution]
   /reinit - don't use given sersicfit (if it exists) as initial conditions
   /fixcen - fix the center at the input xcen, ycen
 OUTPUTS:
   sersicfit - sersic parameters fit
   model - image of best fit model
 OPTIONAL INPUT/OUTPUTS:
 DATA DEPENDENCIES:
 COMMENTS:
   The input psf should be interpreted as an image of a delta
   function source (pixel- and seeing-convolved)
 EXAMPLES:
 BUGS:
   sersic fitting by dsersic currently fails fake data tests
 PROCEDURES CALLED:
 REVISION HISTORY:
   10-Sep-2003  Written by Mike Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/sersic/dsersic.pro)</STRONG><P>
<HR>
 
<A NAME="DSERSIC2">
<H2>DSERSIC2</H2></A>
<A HREF="#DSERSIC">[Previous Routine]</A>
<A HREF="#DSERSIC_PARAMS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dsersic2
 PURPOSE:
   run 2d, two-component sersic fitting on an image
 CALLING SEQUENCE:
   dsersic2,image [,invvar, xcen=, ycen=, psf=, sersicfit=, $
      model=, seed=, /reinit, /fixsky, /fixcenter, /axisymmetric, /simple]
 INPUTS:
   image - [nx,ny] input image
 OPTIONAL INPUTS:
   invvar - [nx,ny] input inverse variance [default to unity everywhere]
   xcen - center of image [default to nx/2L]
   ycen - center of image [default to ny/2L]
   psf - [nxpsf,nypsf] estimated psf [default to just pixel convolution]
   seed - set seed for random initial conditions
 OPTIONAL KEYWORDS:
   /reinit - don't use given sersicfit (if it exists) as initial conditions
   /fixcenter - fix the center at the input xcen, ycen
   /fixsky - do not allow sky to float
   /axisymmetric - allow only axisymmetric fits
   /simple - do not do full sersic integration (faster but less accurate)
   /silent - shut up
   /scramble - forces scramble of angles even if sersicfit set
 INPUTS/OUTPUTS:
   sersicfit - sersic parameters fit (if set, and /reinit not, uses
               as starting point)
 OUTPUTS:
   model - image of best fit model
 COMMENTS:
   The input psf should be interpreted as an image of a delta
   function source (pixel- and seeing-convolved)
 REVISION HISTORY:
   10-Sep-2003  Written by Mike Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/sersic/dsersic2.pro)</STRONG><P>
<HR>
 
<A NAME="DSERSIC_PARAMS">
<H2>DSERSIC_PARAMS</H2></A>
<A HREF="#DSERSIC2">[Previous Routine]</A>
<A HREF="#DSIGMA">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dsersic_params
 PURPOSE:
   given flux, r50, n  
 CALLING SEQUENCE:
   dsersic_params, flux, n, r50, amp=, r0=
 INPUTS:
   flux - flux
   n - Sersic index
   r50 - half-light radius
 OUTPUTS:
   amp - amplitude 
   r0 - radius
 COMMENTS:
   I(r)= amp*exp(-(r/r0)^(1/n))
 REVISION HISTORY:
   2003-09-21  Written MRB (NYU)
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/sersic/dsersic_params.pro)</STRONG><P>
<HR>
 
<A NAME="DSIGMA">
<H2>DSIGMA</H2></A>
<A HREF="#DSERSIC_PARAMS">[Previous Routine]</A>
<A HREF="#DSMOOTH">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dsigma
 PURPOSE:
   find approximate sigma from image
 CALLING SEQUENCE:
   sigma= dsigma(image)
 INPUTS:
   image - [nx, ny] input image
 OPTIONAL INPUTS:
   sp - spacing between nearby pixels (default 2)
 OUTPUTS:
   sigma - estimated sigma
 COMMENTS:
   Takes a bunch of differences between nearby pixels sparsely
   sampled across the image.
 REVISION HISTORY:
   2-Mar-2006  Written by Blanton, NYU (Fink's method)
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dsigma.pro)</STRONG><P>
<HR>
 
<A NAME="DSMOOTH">
<H2>DSMOOTH</H2></A>
<A HREF="#DSIGMA">[Previous Routine]</A>
<A HREF="#DSTARS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dsmooth
 PURPOSE:
   smooth with a simple gaussian
 CALLING SEQUENCE:
   smooth= dsmooth(image, sigma)
 INPUTS:
   image - [nx, ny] input image
   sigma - gaussian sigma
 OUTPUTS:
   smooth - [nx, ny] smooth image
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dsmooth.pro)</STRONG><P>
<HR>
 
<A NAME="DSTARS">
<H2>DSTARS</H2></A>
<A HREF="#DSMOOTH">[Previous Routine]</A>
<A HREF="#DTEMPLATES">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dstars
 PURPOSE:
   find stars in multi-band, multi-res images (called by dchildren)
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dstars.pro)</STRONG><P>
<HR>
 
<A NAME="DTEMPLATES">
<H2>DTEMPLATES</H2></A>
<A HREF="#DSTARS">[Previous Routine]</A>
<A HREF="#DUMMY_PSF">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dtemplates
 PURPOSE:
   build templates around centers  
 CALLING SEQUENCE:
   dtemplates, image, xc, yc, templates= [, parallel=, sigma=, /sersic]
 INPUTS:
   image - [nx, ny] input image
   xc, yc - [N] centers of templates 
 OPTIONAL KEYWORDS;
   /sersic - fit Sersic profile in 2D, and use to taper template
 OPTIONAL INPUTS:
   sigma - typical sky sigma (default is inferred from image)
 OUTPUTS:
   templates - [nx, ny, N] templates around each center
   parallel - how similar two templates are 
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU, based on RHL deblend
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dtemplates.pro)</STRONG><P>
<HR>
 
<A NAME="DUMMY_PSF">
<H2>DUMMY_PSF</H2></A>
<A HREF="#DTEMPLATES">[Previous Routine]</A>
<A HREF="#DVPSF">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dummy_psf
 PURPOSE:
   return a dummy psf for cases where it is unknown
 CALLING SEQUENCE:
   psfstr =dummy_psf(natlas, nx, ny)
 OUTPUTS:
   psfstr - structure with:
             NX
             NY
             COEFFS[NP, NC]
             PSFT[NATLAS, NATLAS, NC]
 COMMENTS:
   returns output like that of dpsfread()
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dummy_psf.pro)</STRONG><P>
<HR>
 
<A NAME="DVPSF">
<H2>DVPSF</H2></A>
<A HREF="#DUMMY_PSF">[Previous Routine]</A>
<A HREF="#DWEIGHTS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dvpsf
 PURPOSE:
   given a PSF structure, return the PSF at a particular point
 CALLING SEQUENCE:
   psf=dvpsf(x, y [, psfsrc=psfsrc)
 INPUTS:
   psfsrc - filename, or structure with:
             NX
             NY
             NP
             NC
             NATLAS
             COEFFS[NP*(NP+1)/2, NC]
             PSFT[NATLAS, NATLAS, NC]
   x, y - location to evaluate psf at
 COMMENTS:
   NATLAS is size of PSF image
   NP is number of polynomial terms in variable fit
   NC is number of components in fit
   Returns an NX by NY image of PSF at given location
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/psf/dvpsf.pro)</STRONG><P>
<HR>
 
<A NAME="DWEIGHTS">
<H2>DWEIGHTS</H2></A>
<A HREF="#DVPSF">[Previous Routine]</A>
<A HREF="#FIT_MULT_GAUSS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   dweights
 PURPOSE:
   fit templates to image
 CALLING SEQUENCE:
   dweights, image, invvar, templates, weights= [, /nonneg ]
 INPUTS:
   image - [nx, ny] input image
   invvar - [nx, ny] input image
   templates - [nx, ny, N] centers of templates 
 OPTIONAL KEYWORDS;
   /nonneg - use nonnegative fitting routine
 OUTPUTS:
   weights - [N] weights assigned to each template
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU, based on RHL deblend
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dweights.pro)</STRONG><P>
<HR>
 
<A NAME="FIT_MULT_GAUSS">
<H2>FIT_MULT_GAUSS</H2></A>
<A HREF="#DWEIGHTS">[Previous Routine]</A>
<A HREF="#SIMPLEXY">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   fit_mult_gauss
 PURPOSE:
   fit multiple gaussians centered at center to an image
 CALLING SEQUENCE:
   fit_mult_gauss, image, ngauss, amp, sigma 
 INPUTS:
   image - image to fit
   ngauss - number of gaussians to fit
 OPTIONAL INPUTS:
 OUTPUTS:
   amp - [ngauss] amplitude of gaussians
   sigma - [ngauss] sigma of gaussians
 OPTIONAL INPUT/OUTPUTS:
 COMMENTS:
 EXAMPLES:
 BUGS:
 PROCEDURES CALLED:
 REVISION HISTORY:
   20-Aug-2003  Written by Mike Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/detect/dfit_mult_gauss.pro)</STRONG><P>
<HR>
 
<A NAME="SIMPLEXY">
<H2>SIMPLEXY</H2></A>
<A HREF="#FIT_MULT_GAUSS">[Previous Routine]</A>
<A HREF="#TWOMASS_CONVERT">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   simplexy
 PURPOSE:
   get basic X and Y for brightish sources away from edge of an image
 CALLING SEQUENCE:
   simplexy, image, x, y, flux
 INPUTS:
   image - [nx, ny] input image
 OUTPUTS:
   x, y - [N] central positions
   flux - [N] central fluxes
 REVISION HISTORY:
   1-Mar-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/utils/simplexy.pro)</STRONG><P>
<HR>
 
<A NAME="TWOMASS_CONVERT">
<H2>TWOMASS_CONVERT</H2></A>
<A HREF="#SIMPLEXY">[Previous Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
   twomass_convert
 PURPOSE:
   convert twomass images to sky-subtracted versions with nice names
 CALLING SEQUENCE:
   twomass_convert, jfile, hfile, kfile, outbase
 COMMENTS:
   Converts all images into nmgy per pixel
   Subtracts out a constant median value across the whole frame.
   Creates an ivar HDU based on sigma (assuming variance scales
     proportional to un-sky-subtacted flux)
 REVISION HISTORY:
   11-Jan-2006  Written by Blanton, NYU
</PRE><P>
<STRONG>(See /home/users/mb144/dimage/pro/utils/twomass_convert.pro)</STRONG><P>
<HR>
 
</body>
</html>
